#!/bin/bash

# Manual control of intel backlight (display brightness)

ARG=$1

if [ -z $ARG ]; then
    echo "USAGE: br [NUMBER]" >& 2
    exit
fi

if ! echo $ARG | egrep "^([1-9][0-9]*|0)$" ; then
    echo "Arg must be a number" >& 2
    exit
fi

if [ $ARG -gt 100 -o $ARG -lt 0 ]; then
    echo "Arg must be a number between 0 and 100" >& 2
    exit
fi

if [ $ARG -lt 3 ]; then
    ARG=3
fi

MAX_BRIGHTNESS=$(cat /sys/class/backlight/intel_backlight/max_brightness | tr -d '\n')
PRCT=$(echo "scale=2; ${ARG}/100" | bc)

BRIGHTNESS=$(echo "($PRCT * $MAX_BRIGHTNESS)" / 1 | bc)

echo $BRIGHTNESS | sudo tee /sys/class/backlight/intel_backlight/brightness
